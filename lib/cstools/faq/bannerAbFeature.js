!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("bannerAbFeature",[],t):"object"==typeof exports?exports.bannerAbFeature=t():e.bannerAbFeature=t()}(self,(function(){return function(){"use strict";var e={d:function(t,n){for(var o in n)e.o(n,o)&&!e.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:n[o]})},o:function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r:function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};function n(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function o(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?n(Object(o),!0).forEach((function(t){r(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):n(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function i(){return Date.now()/1e3|0}e.r(t),e.d(t,{default:function(){return p}}),window.$requestUtil||(window.$requestUtil={sstm:i(),request_id:0,uuid:$util.uuidv4(),infoReported:!1,ccpSessionId:void 0,clientLabel:"IB"});var a=$requestUtil.uuid,u=$requestUtil.sstm,c=function(e,t){t&&(e=null),window.nativeConsole&&"function"==typeof nativeConsole.log&&nativeConsole.log(e),"function"==typeof window.__logger?window.__logger(e):Array.isArray(window.__logs)&&__logs.push([(new Date).toLocaleString(),e])},l=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.headers={},this.baseUrlOverride="",this.paramsPreprocessors=[]}var t,n,r;return t=e,n=[{key:"getBase",value:function(){var e="".concat(document.location.origin,"/tws.proxy");return this.baseUrlOverride||e}},{key:"formatUrl",value:function(e){return 0===e.indexOf("http")?e:this.getBase()+"/"+e}},{key:"addParamsPreprocessor",value:function(e){var t=this;return this.paramsPreprocessors.push(e),function(){t.paramsPreprocessors=t.paramsPreprocessors.filter((function(t){return t!==e}))}}},{key:"formatParams",value:function(e){var t,n=$util.cookie("XYZAB"),r={"Content-Type":"application/json; charset=utf-8","x-session-id":$requestUtil.uuid,"x-request-id":$requestUtil.request_id++,"X-SERVICE":"AM.LOGIN","x-embedded-in":"web","X-WA-VERSION":["5a59b68","Mon, 18 Mar 2024 10:30:48 -0400"]+"/2024-03-18T15:02:50.352Z","x-ccp-session-id":$requestUtil.ccpSessionId,"x-client-label":$requestUtil.clientLabel};null!=(t=n)&&"null"!==(""+t).toLowerCase()&&"undefined"!==(""+t).toLowerCase()&&/^[a-zA-Z0-9!@#$&()`.+,/"-]/i.exec(t)&&(r["X-XYZAB"]=n);var s=o({credentials:"include",headers:r},e);return this.paramsPreprocessors.reduce((function(e,t){return e=t(e)}),s)}},{key:"overrideBase",value:function(e){this.baseUrlOverride=e}},{key:"request",value:function(e,t,n){return c("WA > requesting ".concat(e," with params ").concat(JSON.stringify(t)),n),fetch(this.formatUrl(e),this.formatParams(t)).then((function(t){var o,r,s,i,a,u;t.ok||(window.__appName,null===(o=window)||void 0===o||null===(r=o.navigator)||void 0===r||r.userAgent,null===(s=window)||void 0===s||null===(i=s.navigator)||void 0===i||i.platform,null===(a=window)||void 0===a||null===(u=a.navigator)||void 0===u||u.appVersion,$app.option.theme,$app.option.language,$media,$device,window.region,t.status,t.statusText,t.url);if(t.clone){var l=t.clone();if(l&&l.status&&"401"===l.status.toString())return $app.send({action:"sso_validation_failed"}),Promise.reject(new Error("Session expired"));l.ok?l.text().then((function(t){c("WA > ".concat(e," SUCCESS with response ").concat(t," statusText ").concat(l.statusText," statusCode ").concat(l.status),n)})).catch((function(t){c("WA > ".concat(e," FAILED with response error message ").concat(t?t.message:"Unknown"," statusText ").concat(l.statusText," statusCode ").concat(l.status),n)})):l.text().then((function(t){c("WA > ".concat(e," FAILED with response ").concat(t," statusText ").concat(l.statusText," statusCode ").concat(l.status),n)})).catch((function(t){c("WA > ".concat(e," FAILED with response error message ").concat(t?t.message:"Unknown"," statusText ").concat(l.statusText," statusCode ").concat(l.status),n)}))}else c("WA > ".concat(e," SUCCESS with response ").concat(t," statusText ").concat(t&&t.statusText," statusCode ").concat(t&&t.status),n);return t})).catch((function(t){return c("WA > ".concat(e," FAILED with response ").concat(t?t.message:"Unknown"),n),t}))}},{key:"reportTelemetry",value:function(e){var t,n,r=this,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"unknown",c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},l=null===(t={mode:"production",env:"production",rev:["5a59b68","Mon, 18 Mar 2024 10:30:48 -0400"],platform:"web",date:"2024-03-18T15:02:50.352Z"})||void 0===t?void 0:t.platform,d=$requestUtil.infoReported?void 0:o({prod:"production"==(null===(n={mode:"production",env:"production",rev:["5a59b68","Mon, 18 Mar 2024 10:30:48 -0400"],platform:"web",date:"2024-03-18T15:02:50.352Z"})||void 0===n?void 0:n.env)?1:0},c),f="web"===l||"desktop"===l||"ntws"===l,p={wa_session:a,sstm:u,t:i()-u},w=o({},e,{},p);if(f){$requestUtil.infoReported=!0;var h={sstm:u,info:d,data:w};return this.request("telemetry/authAdd",{method:"POST",body:JSON.stringify(h)}).then((function(e){if(!e.ok&&["401","400"].includes(e.status.toString()))return r.request("telemetry/noAuthAdd",{method:"POST",body:JSON.stringify(o({user:s},h))}).then((function(e){if(e.ok)return e.json();throw"Failed non auth telemetry"}));if(e.ok)return e.json();throw"Failed auth telemetry"})).catch((function(e){console.log(e)}))}$app.send({action:"web_app_telemetry",data:w})}}],n&&s(t.prototype,n),r&&s(t,r),e}(),d=new l;const f=d;function p(e){return"chat"===e?Promise.resolve(!1):new Promise((function(e,t){f.request("abtesting/features/IBOT_WEB_APP",{method:"POST",body:JSON.stringify({type:"featuresMsg",datetime:$date.utc().toString(),context:{applicationId:"IBOT_WEB_APP",features:{SELFSERV_BANNER:0}}})}).then((function(e){if(e.ok)return e.json();throw e.code})).then((function(t){if(!t.context.features.SELFSERV_BANNER||""+t.context.features.SELFSERV_BANNER!="1")throw"Feature SELFSERV_BANNER disabled";e(!0)})).catch((function(){e(!1)}))}))}return t}()}));